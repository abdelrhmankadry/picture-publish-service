# Picture Publishing Service

This repository contains the source code and documentation for the Picture Publishing Service. The service allows registered and logged-in users to upload pictures for acceptance or rejection. An administrator can review all submissions and manage the pictures.

## Table of Contents

- [Overview](#overview)
- [Detailed Requirements](#detailed-requirements)
- [Installation](#installation)
- [Testing](#testing)
- [Usage](#usage)
- [API Docs](#api-docs)
- [Anatomy of Docker files](#anatomy-of-docker-files)

## Overview

It is a website where registered and logged-in users can upload pictures for acceptance or rejection. An administrator will login and review all submissions. Accepted pictures will be assigned a URL which can be accessed by all users (without login). Rejected pictures have their pictures removed but the metadata remains.

## Detailed Requirements

- End-users can register.
  - Registration information: email address, password.
- The landing page shows all accepted pictures' URLs.
  - NON-logged-in users can click on the links to see the pictures.
- Logged-in users can upload a picture along with the following fields:
  - Description.
  - Category.
    - Only three fixed categories: living thing, machine, nature.
  - Attachment (up to 2 Mb) (jpg, png, gif only).
- An administrative user can log in to a separate admin page.
  - Built-in admin with username "admin" and password "admin123".
- The administrative user sees a list of uploaded pictures.
  - List of all uploaded, unprocessed pictures.
    - Anything that was accepted or rejected does not show up here.
- The admin can select a picture to process it.
  - Opens a new page showing description, category, picture dimensions, and displays the picture.
    - Has two buttons "Accept", "Reject".
  - If "Accept" is pressed, a URL is autogenerated for that picture, and it can be displayed on the landing page.
  - If "Reject" is pressed, the picture file is removed from storage, and the data record is marked as "Rejected".

## Installation

To set up the Picture Publishing Service locally, please follow these steps:

1. Clone the repository:

   ```shell
   git clone https://github.com/abdelrhmankadry/picture-publishing-service.git
   ```
2. Navigate to the project directory:

   ```shell
   cd picture-publishing-service
   ```
3. Run the following command to start the services:

   ```shell
   docker-compose up -d
   ```

   This will build the Docker containers and start the Picture Publishing Service, PostgreSQL database, and Nginx server (which hosts the frontend).

4. Once the containers are running, you can access the Picture Publishing Service at `http://localhost` in your web browser.

## Testing

To test the Picture Publishing Service project, you can use Maven. The project includes unit tests to verify the functionality of various components. Follow the steps below to run the tests:

1. Navigate to the project directory:

   ```shell
   cd picture-publishing-service
   ```
2. Run the tests using the following command:

   ```shell
   mvnw.cmd test
   ```

   Maven will compile the project, run the unit tests, and provide the test results.

   Note: Make sure you have an internet connection the first time you run the tests, as Maven will download the required dependencies from the remote Maven repository.

3. After the tests complete, you will see the test results in the console. The output will indicate the number of tests executed, passed, and failed.

Example output:

```
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running com.example.service.PictureServiceTest
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.123 s - in com.example.service.PictureServiceTest
[INFO] -------------------------------------------------------
[INFO] Results:
[INFO]
[INFO] Tests run: 5, Failures: 0, Errors: 0, Skipped: 0
[INFO] -------------------------------------------------------
```
That's it! You have now tested the Picture Publishing Service project using Maven.

## Usage

1. Open the landing page to view accepted pictures' URLs.
   - As a NON-logged in user, you can click on the links to see the pictures.

2. Register a new account.
   - Provide your email address and password to register.

3. Log in to your account.
   - Use your registered email address and password to log in.

4. Upload a picture.
   - Provide the picture's description, category, and attachment (up to 2 Mb) in jpg, png, or gif format.

5. Administrative user login.
   - Use the built-in admin credentials with email "admin@admin.com" and password "admin123" to log in as an administrator.

6. Manage uploaded pictures.
   - On

 the admin page, you can see a list of uploaded, unprocessed pictures.
   - Select a picture to process it, which opens a new page displaying its details.
   - Press the "Accept" button to generate a URL for the picture and display it on the landing page.
   - Press the "Reject" button to remove the picture file from storage and mark the data record as "Rejected".



## API Docs

To use Swagger to view the endpoints of the Picture Publishing Service, you can follow the steps below:

1. Ensure that the Picture Publishing Service is running locally. You can refer to the "Usage" section in the README for instructions on how to start the service.

2. Open a web browser and enter the following URL:

   ```
   http://localhost:8080/swagger-ui.html
   ```

   This URL will open the Swagger UI, which provides a user-friendly interface for exploring and testing the API endpoints.

3. In the Swagger UI, you will see a list of available endpoints grouped by controller classes. Expand the desired controller to view the available endpoints and their details.

That's it! You can now use Swagger to view and interact with the endpoints of the Picture Publishing Service through the Swagger UI.


## Anatomy of Docker files


The Picture Publishing Service is composed of multiple Docker containers, each serving a specific purpose. The architecture consists of the following containers:

1. **picture-publishing-service**: This container hosts the Spring Boot application, which provides the backend functionality of the Picture Publishing Service. It is built using the `Dockerfile-springboot`. This container runs the application on port 8080 and depends on the `db` container for the PostgreSQL database.

2. **nginx**: This container uses the official Nginx image as the base (`nginx:latest`). It serves as a reverse proxy and handles the frontend requests. The HTML, CSS, and JS files required for the frontend are copied into the Nginx server root directory. The `Dockerfile-nginx` is used to build this container, and it exposes port 80 for incoming HTTP traffic. The `nginx` container depends on the `picture-publishing-service` container.

3. **db**: This container uses the official PostgreSQL image (`postgres:13`) as the base. It sets up the PostgreSQL database required by the Picture Publishing Service. The `Dockerfile-postgres` is used to build this container. The container exposes port 5432 for communication with the database. The environment variables `POSTGRES_USER`, `POSTGRES_PASSWORD`, and `POSTGRES_DB` are configured to define the database credentials and name.

The containers are orchestrated using Docker Compose, defined in the `docker-compose.yml` file. Docker Compose allows easy management of multiple containers and their dependencies. The `networks` section in the `docker-compose.yml` file specifies the networks used for communication between the containers.
